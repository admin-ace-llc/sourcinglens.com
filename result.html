<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SourcingLens – Your Analysis Workspace</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Run your purchased SourcingLens Starter or Pro landed-cost analysis here." />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="header">
    <div class="container header-inner">
      <div class="brand-block">
        <a href="index.html#top" class="logo-link" aria-label="SourcingLens home">
          <span class="logo-mark">◎</span>
          <span class="logo-text">Sourcing<span>Lens</span></span>
        </a>
        <p class="tagline">Directional sourcing math before you call a broker.</p>
      </div>
      <nav class="nav-links">
        <a class="nav-link" href="index.html#starter">Pricing</a>
        <a class="nav-link" href="index.html#how-it-works">How it works</a>
      </nav>
    </div>
  </header>

  <main id="top">
    <section class="hero-section">
      <div class="container">
        <div id="purchaseBanner" class="card" style="margin-bottom:1.1rem;">
          <h1 style="margin:0 0 0.35rem;font-size:1.4rem;">You're all set – let's run your analysis</h1>
          <p id="purchaseBannerText" class="hero-sub" style="margin:0;">
            Use the workspace below to generate your Starter or Pro report. You can always come back to this page from your email receipt.
          </p>
        </div>

        <p class="hero-sub">
          This page hosts the same analysis engine shown on the main site, but without the marketing copy. If you purchased Starter, use the
          Starter tab below for a single-SKU run. If you purchased Pro, switch to the Pro tab for a multi-SKU portfolio run.
        </p>
      </div>
    </section>

    <!-- STARTER & PRO WORKSPACE (copied from main site) -->
    <section id="starter" class="paid-section">
      <div class="container">
        <h2>Starter &amp; Pro workspace</h2>
        <p class="pricing-intro">
          Starter is for one SKU. Pro scales to up to five SKUs in a single run, with richer narrative and risk insights. Both tiers unlock
          GPT-4.1-mini-based HS suggestions and 5-country comparison.
        </p>

        <div class="card starter-demo-card">
          <div class="tabs">
            <button class="tab-button active" data-tab="starter-tab">Starter – 1 SKU</button>
            <button class="tab-button" data-tab="pro-tab">Pro – up to 5 SKUs</button>
          </div>

          <div id="starter-tab" class="tab-panel active">
            <form id="starter-form" novalidate onsubmit="return false;">
              <label>
                Product name
                <input type="text" id="starterProductName" required />
              </label>
              <label>
                Product description
                <textarea id="starterProductDescription" rows="2" placeholder="Key materials, use, coatings, electronics, etc." required></textarea>
              </label>
              <label>
                HS code (optional – leave blank to let GPT-4.1-mini suggest)
                <input type="text" id="starterHsCode" placeholder="e.g. 732393" />
              </label>

              <div class="grid-2">
                <label>
                  Current supplier country
                  <select id="starterCurrentCountry" required>
                    <option value="">Select...</option>
                    <option value="china">China</option>
                    <option value="vietnam">Vietnam</option>
                    <option value="mexico">Mexico</option>
                    <option value="india">India</option>
                    <option value="usa">United States</option>
                  </select>
                </label>
                <label>
                  Current unit cost (USD)
                  <input type="number" id="starterUnitCost" min="0" step="0.01" required />
                </label>
              </div>

              <div class="grid-2">
                <label>
                  Annual volume (units)
                  <input type="number" id="starterAnnualVolume" min="1" step="1" required />
                </label>
                <label>
                  Priority
                  <select id="starterPriority">
                    <option value="cost">Lowest cost</option>
                    <option value="balance">Balance cost &amp; risk</option>
                    <option value="nearshore">Nearshoring / USMCA</option>
                    <option value="us">US / local preference</option>
                  </select>
                </label>
              </div>

              <div class="status-row">
                <span id="starterHsStatus" class="status-pill status-idle">HS code: using your input</span>
                <span id="starterStatus" class="status-pill status-idle">Ready to run</span>
              </div>

              <button type="button" class="btn btn-primary btn-full" id="starterRunButton">
                Run Starter analysis
              </button>
              <p class="disclaimer">
                HS suggestions are generated via GPT-4.1-mini and are indicative only. Always confirm with your broker.
              </p>
            </form>

            <div id="starter-results-section" class="results-section nested hidden">
              <div class="results-header">
                <div>
                  <h3>Starter results for <span id="starter-results-product-name"></span></h3>
                  <p id="starter-results-intro" class="results-intro"></p>
                </div>
                <button id="starterDownloadCsvButton" class="btn btn-outline">Download CSV</button>
              </div>
              <div class="results-layout">
                <div class="results-main">
                  <div class="table-card card">
                    <div class="table-caption-row">
                      <p class="caption-title">5-country comparison</p>
                      <p class="caption-note">Directional view based on your inputs and simplified heuristics.</p>
                    </div>
                    <div class="table-wrapper">
                      <table id="starter-results-table">
                        <thead>
                          <tr>
                            <th>Option</th>
                            <th>Unit base</th>
                            <th>Tariff</th>
                            <th>Shipping</th>
                            <th>Total landed</th>
                            <th>Annual cost</th>
                            <th>vs current</th>
                          </tr>
                        </thead>
                        <tbody></tbody>
                      </table>
                    </div>
                  </div>
                </div>
                <aside class="results-side">
                  <div class="card subtle">
                    <h3>Narrative summary</h3>
                    <p id="starter-summary" class="side-text"></p>
                  </div>
                  <div class="card subtle">
                    <h3>Compliance &amp; risk notes</h3>
                    <p id="starter-compliance" class="side-text"></p>
                  </div>
                </aside>
              </div>
            </div>
          </div>

          <div id="pro-tab" class="tab-panel">
            <p class="side-text">
              Pro lets you run up to five SKUs at once. Add up to five product rows, then run the multi-SKU engine to see aggregated results.
            </p>
            <form id="pro-form" novalidate onsubmit="return false;">
              <div id="pro-sku-container"></div>
              <button type="button" class="btn btn-ghost" id="proAddSkuButton">+ Add SKU</button>
              <div class="status-row">
                <span id="proStatus" class="status-pill status-idle">Ready to run (0 SKUs added, max 5)</span>
              </div>
              <button type="button" class="btn btn-primary btn-full" id="proRunButton">
                Run Pro analysis (up to 5 SKUs)
              </button>
            </form>

            <div id="pro-results-section" class="results-section nested hidden">
              <div class="results-header">
                <div>
                  <h3>Pro results (portfolio)</h3>
                  <p id="pro-results-intro" class="results-intro"></p>
                </div>
                <div class="results-actions">
                  <button id="proDownloadCsvButton" class="btn btn-outline">Download portfolio CSV</button>
                  <button id="proDownloadPdfButton" class="btn btn-outline">Download PDF pack (print view)</button>
                </div>
              </div>
              <div class="results-layout">
                <div class="results-main">
                  <div class="table-card card">
                    <div class="table-caption-row">
                      <p class="caption-title">SKU-by-SKU summary</p>
                      <p class="caption-note">Highlights where savings may justify a sourcing project.</p>
                    </div>
                    <div class="table-wrapper">
                      <table id="pro-results-table">
                        <thead>
                          <tr>
                            <th>SKU</th>
                            <th>Suggested lane</th>
                            <th>Annual cost current</th>
                            <th>Annual cost suggested</th>
                            <th>Annual savings</th>
                          </tr>
                        </thead>
                        <tbody></tbody>
                      </table>
                    </div>
                  </div>

                  <div class="metrics-grid">
                    <div class="metric card">
                      <h3>Total estimated annual savings</h3>
                      <p id="pro-total-savings" class="metric-main"></p>
                      <p class="metric-note">Sum of positive savings across all SKUs.</p>
                    </div>
                    <div class="metric card">
                      <h3>Portfolio narrative</h3>
                      <p id="pro-portfolio-summary" class="metric-main"></p>
                    </div>
                  </div>
                </div>

                <aside class="results-side">
                  <div class="card subtle">
                    <h3>Risk drivers panel</h3>
                    <p id="pro-risk-panel" class="side-text"></p>
                  </div>
                  <div class="card subtle">
                    <h3>Top 3 next steps</h3>
                    <ul id="pro-next-steps" class="side-list"></ul>
                  </div>
                  <div class="card subtle">
                    <h3>Save to Pro Monthly</h3>
                    <p class="side-text">
                      If you're logged in via Pro Monthly, you can save this run to your dashboard.
                    </p>
                    <button type="button" class="btn btn-outline btn-full" id="proSaveToDashboardButton">
                      Save latest Pro run to dashboard
                    </button>
                    <p id="dashboardSaveStatus" class="hint"></p>
                  </div>
                </aside>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="container footer-inner">
      <p>© <span id="year">2025</span> SourcingLens. All rights reserved.</p>
      <p class="footer-links">
        <a href="privacy.html">Privacy</a> •
        <a href="terms.html">Terms</a> •
        <a href="disclaimer.html">Disclaimer</a>
      </p>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/html2pdf.js@0.10.1/dist/html2pdf.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="script.js"></script>
  <script src="dashboard.js"></script>
</body>
</html>
